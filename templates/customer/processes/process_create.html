{% extends "customer/core/layouts/customer_base.html" %}
{% block content %}
<div class="container-fluid px-2 px-md-3">

  <!-- Header -->
  <div class="d-flex align-items-start justify-content-between mb-4">
    <div>
      <h1 class="h4 mb-1">Skapa testprocess</h1>
      <div class="text-muted">Skapa din testprocess för att börja skicka tester.</div>
    </div>

    <a class="btn btn-outline-secondary" href="{% url 'processes:process_list' %}">
      Tillbaka
    </a>
  </div>

  {% if form.errors %}
    <div class="alert alert-danger">
      Kontrollera fälten nedan.
    </div>
  {% endif %}

  <div class="row g-4">
    <!-- LEFT: Form -->
    <div class="col-12 col-lg-8">
      <div class="card">
        <div class="card-header bg-white py-3">
          <div class="subheading mb-1">Processdetaljer</div>
          <div class="text-muted small">Grunduppgifter för testprocessen.</div>
        </div>

        <div class="card-body">
          <form method="post" novalidate>
            {% csrf_token %}

            <!-- Name -->
            <div class="mb-3">
              <label class="form-label">Namn</label>
              {{ form.name }}
              {% if form.name.errors %}
                <div class="text-danger small mt-1">{{ form.name.errors|striptags }}</div>
              {% endif %}
            </div>

            
<div class="mb-3">
  <label class="form-label">Taggar (frivilligt)</label>
  {{ form.labels_text }}
  {% if form.labels_text.help_text %}
    <div class="form-text">{{ form.labels_text.help_text }}</div>
  {% endif %}
  {% if form.labels_text.errors %}
    <div class="text-danger small mt-1">{{ form.labels_text.errors|striptags }}</div>
  {% endif %}
</div>

            <!-- SOVA template -->
            <div class="mb-3">
  <label class="form-label">Testmall</label>

  <div class="template-select" role="radiogroup">
    {% for card in template_cards %}
      {% with val=card.value %}
      <label class="template-option">
        <input
          class="template-radio"
          type="radio"
          name="{{ form.sova_template.html_name }}"
          value="{{ val }}"
          {% if form.sova_template.value == val %}checked{% endif %}
          {% if form.sova_template.field.disabled %}disabled{% endif %}
        />

        <span class="template-card">
          <span class="template-icon">
            <i data-feather="{{ card.icon|default:'layers' }}"></i>
          </span>

          <span class="template-text">
            <span class="template-title">{{ card.title }}</span>
            <span class="template-subtitle text-muted">{{ card.subtitle }}</span>
          </span>
        </span>
      </label>
      {% endwith %}
    {% endfor %}
  </div>

  {% if form.sova_template.help_text %}
    <div class="form-text mt-2">{{ form.sova_template.help_text }}</div>
  {% endif %}
  {% if form.sova_template.errors %}
    <div class="text-danger small mt-2">{{ form.sova_template.errors|striptags }}</div>
  {% endif %}
</div>

            <div class="d-flex align-items-center gap-2 mt-4">
              <button class="btn btn-primary" type="submit">Skapa process</button>
              <a class="btn btn-outline-secondary" href="{% url 'processes:process_list' %}">Avbryt</a>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- RIGHT: Help / Summary -->
    <div class="col-12 col-lg-4">
      <div class="card">
        <div class="card-header bg-white py-3">
          <div class="subheading mb-1">Tips</div>
          <div class="text-muted small">För en bra processstart.</div>
        </div>

        <div class="card-body small text-muted">
          <ul class="mb-0 ps-3">
            <li>Välj rätt SOVA-mall, det styr testflödet.</li>
            <li>Jobbtitel och plats hjälper dig hålla ordning.</li>
            <li>Anteckningar kan vara kravprofil eller intern info.</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

</div>
{% endblock %}
