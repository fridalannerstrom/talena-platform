{% extends "../layouts/base.html" %}

{% block title %}Dashboard | Talena{% endblock %}

{% block content %}
  <h1>Dashboard</h1>

    <p>
      Inloggad som: <strong>{{ request.user.get_username }}</strong>
    </p>

    <hr />

    <p style="margin-top: 32px; color: #666;">
      Status: <strong>alive</strong>
    </p>

  <h1 class="h3 mb-3">SOVA Projects</h1>

  {% if error %}
    <div class="alert alert-danger">
      Could not load projects: {{ error }}
    </div>
  {% endif %}

  {% for account in accounts %}
    <div class="card mb-4">
      <div class="card-header">
        <strong>{{ account.name }}</strong>
        <span class="text-muted">({{ account.code }})</span>
      </div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table mb-0">
            <thead>
              <tr>
                <th>ID</th>
                <th>Code</th>
                <th>Name</th>
                <th>Active</th>
              </tr>
            </thead>
            <tbody>
              {% for p in account.projects %}
                <tr style="cursor:pointer"
                    onclick="window.location='{% url 'sova_project_detail' account.code p.code %}'">
                  <td>{{ p.id }}</td>
                  <td><code>{{ p.code }}</code></td>
                  <td>{{ p.name }}</td>
                  <td>
                    {% if p.active %}<span class="badge bg-success">Active</span>{% else %}
                    <span class="badge bg-secondary">Inactive</span>{% endif %}
                  </td>
                </tr>
              {% empty %}
                <tr>
                  <td colspan="4" class="text-muted p-3">No projects found for this account.</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  {% endfor %}

<form method="post" action="{% url 'logout' %}">
  {% csrf_token %}
  <button type="submit">Logga ut</button>
</form>



{% endblock %}